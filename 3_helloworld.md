# はじめてのVulkan

Vulkanを使ったプログラムを一からビルドしていきましょう。

[今回のコード](https://github.com/vulkanstudy/3_helloworld)はこちら。

# VisualStudio

Visual Studio を立ち上げましょう。今回は、「新しいプロジェクトの作成」からプロジェクトを作っていきます。

![VSを立ち上げた直後の表示](3/vs1.png "VSを立ち上げた直後の表示")

「新しいプロジェクトの作成」では、C++の「Windows デスクトップ ウィザード」を選択してください。

![新しいプロジェクトの作成](3/vs2.png "新しいプロジェクトの作成")

Windowsデスクトップウィザードでは、プロジェクトの名前や保存する場所を指定します。
今回のプロジェクト名は、「VulkanTest」にしてみます。
私のアカウント名は、「imagire」なので、ユーザーフォルダ以下の「imagire」の下にファイルを保存していますが、皆さんのユーザーの好きな場所に保存してください。

![新しいプロジェクトを構成します](3/vs3.png "新しいプロジェクトを構成します")

さて、次はプロジェクトのテンプレートの設定です。

今回は、コンソールアプリケーションとして作成してみます。

それ以外は、「空のプロジェクト」として、シンプルに構成してみましょう。

![Windowsデスクトッププロジェクト](3/vs4.png "Windowsデスクトッププロジェクト")

出来上がると、エディタの画面が立ち上がります。

![VS画面](3/vs5.png "VS画面")

このままでは、ファイルが何もないので、プログラムが実行できません。
ファイルを追加していきましょう。

ファイルの追加方法はいくつかありますが、例えば、「ソリューションエクスプローラー」の「ソースファイル」を選択してから右クリックして、
「追加」、「新しい項目」と、順次選択していきます。

![ファイル追加](3/vs6.png "ファイル追加")

「新しい項目の追加」ウィンドウでは、ファイルの種類を選べるので、ここでは「C++ファイル(cpp)」を選択します。
ファイル名は、「main.cpp」などとしておきましょうか。

![新しい項目の追加](3/vs7.png "新しい項目の追加")

新しく追加したコースコードに、プログラムの開始点となるメイン関数を追加します。

ひとまず、何も考えずに、下図のコードを入力してください。
こちらは、Vulkanチュートリアルで、開発環境のテストのために入力しているプログラム([https://vulkan-tutorial.com/Development_environment](https://vulkan-tutorial.com/Development_environment))となります。

![ソースコード](3/vs8.png "ソースコード")

さて、ソースコードが追加されたので、デバッグ実行したくなります。

が、ライブラリの設定をしていないので、プログラムはビルドができません。
それ以前にライブラリのパスが通っていないので、コンパイルの時点でエラーとなります。

きちんと通るようにするには、下記の設定が定番です(GLMのようにヘッダだけの場合は、インクルードが追加すればOK)。

* インクルードファイルのパスを通す
* ライブラリのパスを通す
* 使用するライブラリを追加する。

慣れれば苦ではないですが、いきなりすらすらできるものでもないかもしれないので、ひとつづつ設定していきましょう。

まずは、開発のターゲットを「x86」から「x64」に切り替えておきましょう。

![ターゲットの切り替え](3/vs9.png "ターゲットの切り替え")

さて、インクルードディレクトリの追加です。

メニューの「プロジェクト」の「プロパティ」の設定から、各種ファイルの設定を行っていきます。

なお、開いたプロパティのウィンドウでは、左上の「構成」の項目が「すべての構成」になっていることを確かめてください。
こちら、デバック版とリリース版の設定の切り替えになりますが、今回は、ともに同じ設定を用いるので、一回にまとめて設定をします
（異なる設定の際は、こちらのタブを切り替えて、それぞれの設定を行ってください）。

![プロジェクトのプロパティ](3/vs10.png "プロジェクトのプロパティ")

「構成プロパティ」の「C/C++」の「全般」にある「追加のインクルードディレクトリ」から、プルダウンでメニューを選択して、「編集」に入ってください。

![インクルードディレクトリの追加](3/vs11.png "インクルードディレクトリの追加")

追加するインクルードディレクトリは、Vulkan SDK のインクルードディレクトリと、GLFW, GLM のインクロードディレクトリになります。
Vulkan SDK のインクルードファイルは、ディフォルトのインストール設定では「C:\VulkanSDK\バージョン\include」の中にあるので、このディレクトリを追加します。
GLFW, GLMについては、「C:\OpenGL\include」の下に、それぞれのライブラリが入ったフォルダをコピーしましたので、その上位のディレクトリを追加します。

![追加インクルードディレクトリ](3/vs12.png "追加インクルードディレクトリ")

次は、ライブラリの追加です。
まずは、ディレクトリを追加します。

今度は、「リンカー」の「全般」にある「追加のライブラリディレクトリ」を編集してください。

![ライブラリディレクトリの追加](3/vs13.png "ライブラリディレクトリの追加")

追加するフォルダは、「C:\VulkanSDK\バージョン\Lib」と、GLFWのライブラリが置かれた「C:\OpenGL\lib」になります。

![追加ライブラリディレクトリ](3/vs14.png "追加ライブラリディレクトリ")

次に、ライブラリファイルの指定です。
ライブラリファイルを確認してみましょう。
「C:\VulkanSDK\バージョン\Lib」に入ると、いくつかのファイルがあります。この中の「vulkan-1.lib」が目的のファイルです。

![ValkanのLibファイル](3/vs15.png "ValkanのLibファイル")

「リンカー」の「入力」にある「追加の依存ファイル」を編集してください。

![追加の依存ファイル](3/vs16.png "追加の依存ファイル")

こちらに、今回のライブラリである、「vulkan-1.lib」とGLFWのライブラリである「glfw3.lib」を追加します。

![依存ファイルの追加](3/vs17.png "依存ファイルの追加")

追加結果は次のようになっているかと思います。

![C++言語標準](3/vs18.png "C++言語標準")


あと、Vulkanチュートリアルでは、C++のバーションも指定していました。
「ISO C++ 17 標準」指定されていて、特に問題がないのであれば、こちらを指定してよいでしょう。

![C++言語標準](3/vs19.png "C++言語標準")

ついに実行です！

といっても、今回は、白い画面が表示されるだけとなります。

![実行結果](3/vs20.png "実行結果")

ここから、どんどんと表示をしていきましょう。

* [戻る](./)
